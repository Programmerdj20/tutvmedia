---
import MainLayout from '../layouts/MainLayout.astro';
import MovieCarousel from '../components/MovieCarousel.astro';
import { getPopularMovies, getTrendingMovies, getImageUrl } from '../services/tmdb';

// Obtener películas
const [popularMovies, trendingMovies] = await Promise.all([
	getPopularMovies(1),
	getTrendingMovies('week'),
]);

// Featured movie (la primera película popular)
const featuredMovie = popularMovies.results[0];
const backdropUrl = featuredMovie ? getImageUrl(featuredMovie.backdrop_path, 'original') : '';
---

<MainLayout title="TutvMedia - Películas y Series" description="Descubre películas y series populares con TutvMedia">
	<!-- Hero Section -->
	{
		featuredMovie && (
			<section
				class="relative h-[600px] overflow-hidden bg-gradient-to-b from-blue-50 to-white"
				style={{
					backgroundImage: `linear-gradient(135deg, rgba(59, 130, 246, 0.2), rgba(147, 197, 253, 0.1)), url('${backdropUrl}')`,
					backgroundSize: 'cover',
					backgroundPosition: 'center',
				}}
			>
				<div class="absolute inset-0 bg-gradient-to-r from-white via-white/50 to-transparent"></div>

				<div class="relative h-full max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex items-center">
					<div class="max-w-2xl">
						<div class="mb-4">
							<span class="inline-block px-4 py-1 bg-blue-100 text-blue-700 text-sm font-semibold rounded-full">
								Destacado
							</span>
						</div>

						<h1 class="text-5xl sm:text-6xl font-bold text-gray-900 mb-4 leading-tight">
							{featuredMovie.title}
						</h1>

						<div class="flex items-center gap-6 mb-6">
							<div class="flex items-center gap-2">
								<span class="text-2xl font-bold text-yellow-500">★</span>
								<span class="text-lg font-semibold text-gray-900">
									{featuredMovie.vote_average.toFixed(1)}/10
								</span>
							</div>
							<div class="text-gray-600">
								{new Date(featuredMovie.release_date).getFullYear()}
							</div>
						</div>

						<p class="text-gray-700 text-lg mb-8 leading-relaxed line-clamp-3">
							{featuredMovie.overview}
						</p>

						<div class="flex gap-4">
							<button class="btn-primary">
								▶ Ver Ahora
							</button>
							<button class="btn-secondary">
								+ Mi Lista
							</button>
						</div>
					</div>
				</div>
			</section>
		)
	}

	<!-- Películas Populares -->
	{
		popularMovies.results.length > 0 && (
			<MovieCarousel
				title="Películas Populares"
				subtitle="Las películas más vistas en este momento"
				movies={popularMovies.results}
			/>
		)
	}

	<!-- Películas en Tendencia -->
	{
		trendingMovies.results.length > 0 && (
			<MovieCarousel
				title="En Tendencia Esta Semana"
				subtitle="Lo más visto en los últimos 7 días"
				movies={trendingMovies.results}
			/>
		)
	}

	<!-- CTA Section -->
	<section class="py-16 bg-gradient-to-r from-blue-500 to-blue-600 text-white">
		<div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
			<h2 class="text-4xl font-bold mb-4">
				Explora Miles de Películas
			</h2>
			<p class="text-blue-100 text-lg mb-8 max-w-2xl mx-auto">
				Descubre tu próxima película o serie favorita. Acceso a miles de títulos de todo el mundo.
			</p>
			<button class="px-8 py-4 bg-white text-blue-600 font-bold rounded-lg hover:bg-blue-50 transition-colors">
				Empezar Exploración
			</button>
		</div>
	</section>

	<!-- Info Section -->
	<section class="py-16 bg-blue-50">
		<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
			<h2 class="text-3xl font-bold text-gray-900 text-center mb-12">
				¿Por qué TutvMedia?
			</h2>

			<div class="grid grid-cols-1 md:grid-cols-3 gap-8">
				<div class="card p-8 text-center">
					<div class="w-16 h-16 bg-gradient-to-br from-blue-400 to-blue-600 rounded-lg flex items-center justify-center mx-auto mb-4">
						<svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
							<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.828 14.828a4 4 0 01-5.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
						</svg>
					</div>
					<h3 class="text-xl font-bold text-gray-900 mb-2">Recomendaciones</h3>
					<p class="text-gray-600">Descubre películas basadas en tus preferencias y gustos personalizados.</p>
				</div>

				<div class="card p-8 text-center">
					<div class="w-16 h-16 bg-gradient-to-br from-blue-400 to-blue-600 rounded-lg flex items-center justify-center mx-auto mb-4">
						<svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
							<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
						</svg>
					</div>
					<h3 class="text-xl font-bold text-gray-900 mb-2">Rápido</h3>
					<p class="text-gray-600">Interfaz optimizada para encontrar lo que quieres en segundos.</p>
				</div>

				<div class="card p-8 text-center">
					<div class="w-16 h-16 bg-gradient-to-br from-blue-400 to-blue-600 rounded-lg flex items-center justify-center mx-auto mb-4">
						<svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
							<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"></path>
						</svg>
					</div>
					<h3 class="text-xl font-bold text-gray-900 mb-2">Personalizable</h3>
					<p class="text-gray-600">Ajusta tus preferencias y crea listas personalizadas fácilmente.</p>
				</div>
			</div>
		</div>
	</section>
</MainLayout>
